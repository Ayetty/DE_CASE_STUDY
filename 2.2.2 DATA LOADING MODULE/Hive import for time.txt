USE DEFAULT;

DROP TABLE CDW_SAPP_D_TIME_ONE;

CREATE  EXTERNAL TABLE CDW_SAPP_D_TIME_ONE
(TIMEID String,
DAY Int, 
MONTH Int, 
QUARTER String, 
YEAR Int) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'
LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_D_TIME";

DROP TABLE CDW_SAPP_D_TIME;

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE  EXTERNAL TABLE CDW_SAPP_D_TIME
(TIMEID String,
DAY Int, 
MONTH Int, 
QUARTER String)
PARTITIONED BY (YEAR Int)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'

LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_D_TIME";

INSERT OVERWRITE TABLE CDW_SAPP_D_TIME
PARTITION (YEAR)
SELECT TIMEID,
DAY, 
MONTH, 
QUARTER, 
YEAR) 

from CDW_SAPP_D_TIME_ONE;