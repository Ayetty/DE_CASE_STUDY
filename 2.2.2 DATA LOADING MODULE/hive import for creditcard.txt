USE DEFAULT;

DROP TABLE IF EXISTS CDW_SAPP_F_CREDIT_CARD_ONE;

CREATE  EXTERNAL TABLE CDW_SAPP_F_CREDIT_CARD_ONE (
CUST_CC_NO STRING,
TIME_ID STRING,
CUST_SSN INT, 
BRANCH_CODE INT, 
TRANSACTION_TYPE string, 
TRANSACTION_VALUE DOUBLE, 
TRANSACTION_ID INT) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'
LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_F_CREDIT_CARD";

DROP TABLE IF EXISTS CDW_SAPP_F_CREDIT_CARD;

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE  EXTERNAL TABLE CDW_SAPP_F_CREDIT_CARD
(CUST_CC_NO STRING,
TIME_ID STRING,
CUST_SSN INT, 
BRANCH_CODE INT,  
TRANSACTION_VALUE DOUBLE, 
TRANSACTION_ID INT)
PARTITIONED BY (TRANSACTION_TYPE STRING)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'

LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_F_CREDIT_CARD";

INSERT OVERWRITE TABLE CDW_SAPP_F_CREDIT_CARD
PARTITION (TRANSACTION_TYPE)
SELECT CUST_CC_NO,
TIME_ID,
CUST_SSN, 
BRANCH_CODE,  
TRANSACTION_VALUE, 
TRANSACTION_ID,
TRANSACTION_TYPE

from CDW_SAPP_F_CREDIT_CARD_ONE;